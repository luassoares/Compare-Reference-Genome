install.packages("pegas")
vcf = read.vcfR("populations.snps.vcf")
help(read.vcfR)
??read.vcfR
install.packages("vcfR")
vcf = read.vcfR("populations.snps.vcf")
browseVignettes('vcfR')
vcf = read.vcf("populations.snps.vcf")
help(read.vcf)
library(admixr)
install.packages("admixr")
library(admixr)
library(admixr)
library(devtools)
library(devtools)
install.packages("stats", type = "binary")
# Generate a sequence of values for X
x <- seq(0, 20, by = 0.1)
# Calculate the probability density function (PDF) of X
pdf <- dlnorm(x, meanlog = 6.2666, sdlog = 0.13)
# Calculate the probability density function (PDF) of X
pdf <-
dlnorm(x, meanlog = 6.2666, sdlog = 0.13)
library(stats)
install.packages("stats")
library(stats, lib.loc = "C:/Program Files/R/R-4.2.0/library")
# Generate a sequence of values for X
x <- seq(0, 20, by = 0.1)
# Generate a sequence of values for X
x <- seq(0, 20, by = 0.1)
# Calculate the probability density function (PDF) of X
pdf <- dlnorm(x, meanlog = 6.2666, sdlog = 0.13)
# Plot the PDF of X
plot(x, pdf, type = "l", lwd = 2, xlab = "X", ylab = "PDF", main = "Lognormal distribution")
# Generate a sequence of values for X
x <- seq(0, 200, by = 0.1)
# Calculate the probability density function (PDF) of X
pdf <- dlnorm(x, meanlog = 6.2666, sdlog = 0.13)
# Plot the PDF of X
plot(x, pdf, type = "l", lwd = 2, xlab = "X", ylab = "PDF", main = "Lognormal distribution")
??makeCluster
library(dartR)
citation("dartR")
library(pophelper)
setwd("E:/DART_/05_COMPARE/11_ANALYSIS-NEW/03_fastSTRUCTURE")
file <- "RESULT_alt-80-aaxi-miss5.str/fS_run_K.3.meanQ"
readQ(files=file)
files <- "RESULT_alt-80-aaxi-miss5.str/"
readQ(files=files)
list = readQ(files=files)
sfiles <- list.files(path="E:/DART_/05_COMPARE/11_ANALYSIS-NEW/03_fastSTRUCTURE/RESULTS-BESTK-ALL/", full.names=T)
sfiles
slist<- readQ(files=sfiles)
View(slist)
09_miss <- slist[,c(3,7,11,15,19,23,27,31,35,39,43,47,51,55,59,63,67,71)]
09miss <- slist[,c(3,7,11,15,19,23,27,31,35,39,43,47,51,55,59,63,67,71)]
missing09 <-slist[,c(3,7,11,15,19,23,27,31,35,39,43,47,51,55,59,63,67,71)]
View(slist)
slist[,1]
plotQ(slist[1])
??plotQ
plotQ(slist[1],exportpath=getwd())
setwd("E:/DART_/05_COMPARE/11_ANALYSIS-NEW/03_fastSTRUCTURE/01_RESULTS-BESTK-ALL/")
plotQ(qlist=readQ(sfiles)[c(3,7,11,15)], imgoutput="sep",exportpath="./FIGURAS/")
sfiles <- list.files(path="E:/DART_/05_COMPARE/11_ANALYSIS-NEW/03_fastSTRUCTURE/01_RESULTS-BESTK-ALL/", full.names=T)
slist<- readQ(files=sfiles)
slist
View(slist)
plotQ(slist[1],exportpath=getwd())
plotQ(qlist=readQ(sfiles)[c(3,7,11,15)], imgoutput="sep",exportpath="./FIGURAS/")
(qlist[c(3,7,11,15)]
)
plotQ(slist[c(3,7,11,15)], imgoutput="sep",exportpath="./FIGURAS/")
plotQ(slist[c(3,7,11,15)], imgoutput="joint",exportpath="./FIGURAS/")
plotQ(slist[c(3,7,11,15)], imgoutput="join",exportpath="./FIGURAS/")
plotQ(slist[c(3,7,11,15)], imgoutput="join",returnplot=T,exportplot=F)
plotQ(slist[c(3,7,11,15)], imgoutput="join",returnplot=T,exportplot=F,basesize=11)
plotQ(slist[c(3,7,11,15,19,23)], imgoutput="join",returnplot=T,exportplot=F,basesize=11)
grp41 <- plotQ(slist[c(31,35,39,43,47,51)], imgoutput="join",returnplot=T,exportplot=F,basesize=11)
grp41 <- plotQ(slist[c(27,31,35,39,43,47)], imgoutput="join",returnplot=T,exportplot=F,basesize=11)
print(grp41)
phylo <- plotQ(slist[c(51,55,59,63,67,71)], imgoutput="join",returnplot=T,exportplot=F,basesize=11)
print(phylo)
phylo <- plotQ(slist[c(51,55,63,67,71,59)], imgoutput="join",returnplot=T,exportplot=F,basesize=11)
print(phylo)
help("pophelper::plotQ")
??pophelper::plotQ
plotQ(slist[c(27,31,35,39,43,47)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,showlegend=T)
plotQ(slist[c(27,31,35,39,43,47)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T,legendkeysize=10,legendtextsize=10,legendmargin=c(2,2,2,0))
plotQ(slist[c(3,7,11,15,19,23)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
sortind="all")
getwd()
popmap_alt80 <- read.csv("popmap-alt80.txt")
View(popmap_alt80)
popmap_alt80 <- read.csv("popmap-alt80.txt",header = F)
plotQ(slist[c(3,7,11,15,19,23)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
grplab = popmap_alt80)
plotQ(slist[c(3,7,11,15,19,23)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
grplab = popmap_alt80, grplabsize=4,linesize=0.8,pointsize=4)
grplab = popmap_alt80, grplabsize=4,linesize=0.8,pointsize=4
plotQ(slist[c(3,7,11,15,19,23)], imgoutput="join",returnplot=T,exportplot=F,basesize=11
plotQ(slist[c(3,7,11,15,19,23)], imgoutput="join",returnplot=T,exportplot=F,basesize=11
popmap_alt80 <- read.csv("popmap-alt80.txt",header = F)
plotQ(slist[c(3,7,11,15,19,23)], imgoutput="join",returnplot=T,exportplot=F,basesize=11
# grplab = popmap_alt80, grplabsize=4,linesize=0.8,pointsize=4
)
plotQ(slist[c(3,7,11,15,19,23)], imgoutput="join",returnplot=T,exportplot=F,basesize=11
grplab = popmap_alt80, grplabsize=4,linesize=0.8,pointsize=4
plotQ(slist[c(3,7,11,15,19,23)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
grplab = popmap_alt80, grplabsize=4,linesize=0.8,pointsize=4
)
head(popmap_alt80, "label")
head(popmap_alt80)
colnames(popmap_alt80) <- "label"
View(popmap_alt80)
plotQ(slist[c(3,7,11,15,19,23)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
grplab = popmap_alt80, grplabsize=4,linesize=0.8,pointsize=4
)
plotQ(slist[c(3,7,11,15,19,23)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
grplab=popmap_alt80, grplabsize=4,linesize=0.8,pointsize=4,showindlab=T,indlabwithgrplab=T
)
exemple_files<- list.files(path=system.file("files/structure",package="pophelper"),full.names=T)
ex_slist <- readQ(files=exemple_files)
View(ex_slist)
ex_slist[1]
slist[1]
ex_slist <- readQ(files=exemple_files,indlabfromfile=TRUE))
ex_slist <- readQ(files=exemple_files,indlabfromfile=TRUE)
slist[1]
inds <- read.delim(system.file("files/structureindlabels.txt",package="pophelper"),header=FALSE,stringsAsFactors=F)
View(inds)
indmap_alt80 <- read.csv("indmap-alt80.txt", header = F)
View(popmap_alt80)
View(indmap_alt80)
alt80 <- slist[c(3,7,11,15,19,23)]
View(alt80)
phylo <- slist[c(51,55,63,67,71,59)]
#add indv information
# if all runs are equal length, add indlab to all runs
if(length(unique(sapply(alt80,nrow)))==1) slist <- lapply(slist,"rownames<-",indmap_alt80$V1)
rownames(alt80[[1)]]
rownames(alt80[[1]]
)
#add indv information
rownames(alt80[[1]]) <- indmap_alt80$V1
# if all runs are equal length, add indlab to all runs
if(length(unique(sapply(alt80,nrow)))==1) alt80 <- lapply(slist,"rownames<-",indmap_alt80$V1)
# if all runs are equal length, add indlab to all runs
if(length(unique(sapply(alt80,nrow)))==1) alt80 <- lapply(alt80,"rownames<-",indmap_alt80$V1)
# show row names of all runs and all samples
lapply(alt80, rownames)[1:2]
indmap_grp41 <- read.csv("indmap-grp41.txt", header = F)
indmap_phylo <- read.csv("indmap-phylo.txt", header = F)
# if all runs are equal length, add indlab to all runs
if(length(unique(sapply(grp41,nrow)))==1) grp41 <- lapply(grp41,"rownames<-",indmap_grp41$V1)
View(grp41)
grp41 <- slist[c(27,31,35,39,43,47)]
# if all runs are equal length, add indlab to all runs
if(length(unique(sapply(alt80,nrow)))==1) alt80 <- lapply(alt80,"rownames<-",indmap_alt80$V1)
if(length(unique(sapply(phylo,nrow)))==1) phylo <- lapply(phylo,"rownames<-",indmap_phylo$V1)
View(phylo)
View(indmap_phylo)
indmap_phylo <- read.csv("indmap-phylo.txt", header = F)
if(length(unique(sapply(phylo,nrow)))==1) phylo <- lapply(phylo,"rownames<-",indmap_phylo$V1)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T,
)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T
)
alt80[[1]]
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,indlabangle=45)
popmap_alt80 <- read.csv("popmap-alt80.txt")
View(popmap_alt80)
nrow(popmap_alt80)
sapply(popmap_alt80, is.character)
indmap_alt80 <- read.csv("indmap-alt80.txt", header = F,stringsAsFactors=F)
sapply(popmap_alt80, is.character)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
grplab=popmap_alt80,grplabsize=4,linesize=0.8,pointsize=4)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
# showlegend=T, showindlab=T,useindlab=T,
grplab=popmap_alt80,grplabsize=4,linesize=0.8,pointsize=4)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
grplab=popmap_alt80,grplabsize=4,linesize=0.8,pointsize=4,  showindlab=T,indlabwithgrplab=T)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
grplab=popmap_alt80,grplabsize=4,linesize=0.8,pointsize=4,indlabwithgrplab=T)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
grplab=popmap_alt80$popmap,grplabsize=4,linesize=0.8,pointsize=4,indlabwithgrplab=T)
popmap_phylo <- read.csv("popmap-phylo.txt")
popmap_grp41 <- read.csv("popmap-grp41.txt")
popmap_phylo <- read.csv("popmap-phylo.txt")
plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
grplab=popmap_grp41,grplabsize=4,linesize=0.8,pointsize=4,indlabwithgrplab=T)
plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
)
if(length(unique(sapply(grp41,nrow)))==1) grp41 <- lapply(grp41,"rownames<-",indmap_grp41$V1)
plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
)
if(length(unique(sapply(phylo,nrow)))==1) phylo <- lapply(phylo,"rownames<-",indmap_phylo$V1)
plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
grplab=popmap_grp41,grplabsize=4,linesize=0.8,pointsize=4,indlabwithgrplab=T
)
plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
grplab=popmap_grp41,grplabsize=4,linesize=0.8,pointsize=4
)
plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=F,useindlab=T,
grplab=popmap_grp41,grplabsize=4,linesize=0.8,pointsize=4
)
slist1 <- sapply(ex_slist,function(x) x[c(1:5,20:25,50:55,100:105,130:135),])
# read labels for STRUCTURE runs
threelabset <- read.delim(system.file("files/metadata.txt", package="pophelper"), header=T,stringsAsFactors=F)
head(threelabset)
# length of labels equal to number of individuals?
nrow(threelabset)
# check if labels are a character data type
sapply(threelabset, is.character)
# create short set to match slist1
onelabset <- threelabset[,2,drop=FALSE]
threelabset1 <- threelabset[c(1:5,20:25,50:55,100:105,130:135),]
twolabset1 <- threelabset1[,2:3]
onelabset1 <- threelabset1[,2,drop=FALSE]
head(onelabset1)
View(onelabset1)
View(popmap_grp41)
plotQ(slist1[1],returnplot=T,exportplot=F,basesize=11,
grplab=onelabset1,grplabsize=4,linesize=0.8,pointsize=4)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label")
cores_alt <- c("#6aaec6","#3b6a87","#ffe3b2")
cores_grp <- c("#e07342", "#95c073", "#f8961e", "#8a312b")
cores_phy <- c("#5c9ead","#da8e95","#735d78","#e07a5f","#7cb684")
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=F,useindlab=T,
clustercol = cores_grp
)
cores_grp <- c("#e07342", "#95c073", "#f8961e", "#ff7118","#8a312b")
plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=F,useindlab=T,
clustercol = cores_grp
)
if(length(unique(sapply(phylo,nrow)))==1) phylo <- lapply(phylo,"rownames<-",indmap_phylo$V1)
plotQ(phylo[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=F,useindlab=T,
clustercol = cores_phy
)
plotQ(phylo[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
alt80_plot<- plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
grp41_plot<- plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
phylo_plot <- plotQ(phylo[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
ggsave(phylo_plot, "phylo_fastSTRUCTURE_miss9.svg")
library(ggplot2)
ggsave(phylo_plot, "phylo_fastSTRUCTURE_miss9.svg")
ggsave("phylo_fastSTRUCTURE_miss9.svg", plot = phylo_plot)
svg("alt80_fastSTRUCTURE_miss9.svg", width = 8, height = 7)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
dev.off()
svg("alt80_fastSTRUCTURE_miss9.svg", width = 7, height = 8)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
dev.off()
svg("grp41_fastSTRUCTURE_miss9.svg", width = 7, height = 8)
grp41_plot<- plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
dev.off()
svg("phylo_fastSTRUCTURE_miss9.svg", width = 7, height = 8)
phylo_plot <- plotQ(phylo[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
dev.off()
grp41_plot<- plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
grp41_plot<- plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
plotQ(alt80[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
svg("grp41_fastSTRUCTURE_miss9.svg", width = 7, height = 8)
plotQ(grp41[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
dev.off()
svg("phylo_fastSTRUCTURE_miss9.svg", width = 7, height = 8)
plotQ(phylo[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
dev.off()
sfiles <- list.files(path="E:/DART_/05_COMPARE/11_ANALYSIS-NEW/03_fastSTRUCTURE/01_RESULTS-BESTK-ALL/", full.names=T)
slist<- readQ(files=sfiles)
slist<- readQ(files=sfiles)
sfiles <- list.files(path="E:/DART_/05_COMPARE/11_ANALYSIS-NEW/03_fastSTRUCTURE/01_RESULTS-BESTK-ALL/", full.names=T)
slist<- readQ(files=sfiles)
sfiles <- list.files(path="E:/DART_/05_COMPARE/11_ANALYSIS-NEW/03_fastSTRUCTURE/01_RESULTS-BESTK-ALL/", full.names=T)
slist<- readQ(files=sfiles)
sfiles
sfiles <- list.files(path="E:/DART_/05_COMPARE/11_ANALYSIS-NEW/03_fastSTRUCTURE/01_RESULTS-BESTK-ALL/", full.names=T,pattern = "\\.meanQ$")
sfiles <- list.files(path="E:/DART_/05_COMPARE/11_ANALYSIS-NEW/03_fastSTRUCTURE/01_RESULTS-BESTK-ALL/", full.names=T,pattern = "\\.meanQ$")
sfiles
slist<- readQ(files=sfiles)
slist
View(slist)
sfiles
################## Plot miss50 ########################
alt80_miss5 <- slist[c(1,5,9,13,17,21)]
grp41_miss5 <- slist[c(25,29,33,37,41,45)]
phylo_miss5 <- slist[c(49,53,57,61,65,69)]
phylo_miss5
View(phylo_miss5)
svg("alt80_fastSTRUCTURE_miss5.svg", width = 7, height = 8)
plotQ(alt80_miss5[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
dev.off()
svg("grp41_fastSTRUCTURE_miss5.svg", width = 7, height = 8)
plotQ(grp41_miss5[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
dev.off()
# if all runs are equal length, add indlab to all runs
if(length(unique(sapply(alt80_miss5,nrow)))==1) alt80_miss5 <- lapply(alt80_miss5,"rownames<-",indmap_alt80$V1)
if(length(unique(sapply(grp41_miss5,nrow)))==1) grp41_miss5 <- lapply(grp41_miss5,"rownames<-",indmap_grp41$V1)
if(length(unique(sapply(phylo_miss5,nrow)))==1) phylo_miss5 <- lapply(phylo_miss5,"rownames<-",indmap_phylo$V1)
plotQ(alt80_miss5[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
svg("alt80_fastSTRUCTURE_miss5.svg", width = 7, height = 8)
plotQ(alt80_miss5[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
dev.off()
plotQ(grp41_miss5[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
svg("grp41_fastSTRUCTURE_miss5.svg", width = 7, height = 8)
plotQ(grp41_miss5[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
dev.off()
plotQ(phylo[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
svg("phylo_fastSTRUCTURE_miss5.svg", width = 7, height = 8)
plotQ(phylo[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
dev.off()
plotQ(phylo_miss5[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
svg("phylo_fastSTRUCTURE_miss5.svg", width = 7, height = 8)
plotQ(phylo_miss5[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
dev.off()
slist
sfiles
################## Plot miss80 ########################
alt80_miss8 <- slist[c(2,6,10,14,18,22)]
grp41_miss8 <- slist[c(26,30,34,38,42,46)]
phylo_miss8 <- slist[c(50,54,58,62,66,70)]
# if all runs are equal length, add indlab to all runs
if(length(unique(sapply(alt80_miss8,nrow)))==1) alt80_miss8 <- lapply(alt80_miss8,"rownames<-",indmap_alt80$V1)
if(length(unique(sapply(grp41_miss8,nrow)))==1) grp41_miss8 <- lapply(grp41_miss8,"rownames<-",indmap_grp41$V1)
if(length(unique(sapply(phylo_miss8,nrow)))==1) phylo_miss8 <- lapply(phylo_miss8,"rownames<-",indmap_phylo$V1)
svg("alt80_fastSTRUCTURE_miss8.svg", width = 7, height = 8)
plotQ(alt80_miss8[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
dev.off()
plotQ(alt80_miss8[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
plotQ(grp41_miss8[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
svg("grp41_fastSTRUCTURE_miss8.svg", width = 7, height = 8)
plotQ(grp41_miss8[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
dev.off()
svg("phylo_fastSTRUCTURE_miss8.svg", width = 7, height = 8)
plotQ(phylo[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
dev.off()
svg("phylo_fastSTRUCTURE_miss8.svg", width = 7, height = 8)
plotQ(phylo_miss8[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
dev.off()
plotQ(phylo_miss8[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
################## Plot miss95 ########################
alt80_miss95 <- slist[c(2,6,10,14,18,22)]
sfiles
################## Plot miss95 ########################
alt80_miss95 <- slist[c(4,8,12,16,20,24)]
grp41_miss95 <- slist[c(28,32,36,40,44,48)]
phylo_miss95 <- slist[c(52,56,60,64,68,72)]
# if all runs are equal length, add indlab to all runs
if(length(unique(sapply(alt80_miss95,nrow)))==1) alt80_miss95 <- lapply(alt80_miss95,"rownames<-",indmap_alt80$V1)
if(length(unique(sapply(grp41_miss95,nrow)))==1) grp41_miss95 <- lapply(grp41_miss95,"rownames<-",indmap_grp41$V1)
if(length(unique(sapply(phylo_miss95,nrow)))==1) phylo_miss95 <- lapply(phylo_miss95,"rownames<-",indmap_phylo$V1)
plotQ(alt80_miss95[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
svg("alt80_fastSTRUCTURE_miss95.svg", width = 7, height = 8)
plotQ(alt80_miss95[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
sortind="label", clustercol = cores_alt)
dev.off()
svg("grp41_fastSTRUCTURE_miss95.svg", width = 7, height = 8)
plotQ(grp41_miss95[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_grp
)
dev.off()
svg("phylo_fastSTRUCTURE_miss95.svg", width = 7, height = 8)
plotQ(phylo_miss95[c(1:6)], imgoutput="join",returnplot=T,exportplot=F,basesize=11,
showlegend=T, showindlab=T,useindlab=T,
clustercol = cores_phy
)
dev.off()
